Security and State Monotonicity Plan (verack credential + verifiable head)

Scope
4) Tests, metrics, and operational knobs
-------------------------------------------------------------------------------
4) Wiring and gating

- On handshake success: AppendPeerAdded(remotePeerID) if not already present; this grows height.
- VersionMsg now carries AuthScheme/AuthProof and StateHeadCID/StateHeight.
- Gate remains: drop on handshake failure; reset non-handshake streams until verified.

-------------------------------------------------------------------------------
5) Operational knobs and security notes

- Credential management: secret from file/env; rotation requires rolling update.
- Admission strength: this is app-layer; combine with libp2p conn gater and/or pnet if hard isolation is required.
- Privacy: head CID reveals state size indirectly; acceptable for now. Optionally disable advertisement via policy.
- Metrics: handshake credential pass/fail, sync attempts, events applied, chain validation errors.

-------------------------------------------------------------------------------
6) Milestones and estimates (rough)

M5: Integration + metrics + polish ...................................... 0.5â€“1 day

Stretch
- Additional event kinds (content additions), compaction/snapshots, incremental proofs
- Optional: switch from ad-hoc CBOR to ipld-prime typed schemas for stronger guarantees